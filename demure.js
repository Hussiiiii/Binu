const playlist = [
  {
    file: "music/demure/Kiss Me.mp3",
    title: "Kiss Me",
    cover: "images/demure/Kiss Me.jpg"
  },
  {
    file: "music/demure/Put Your Records On.mp3",
    title: "Put Your Records On",
    cover: "images/demure/Put Your Records On.jpg"
  },
  {
    file: "music/demure/Genie In a Bottle.mp3",
    title: "Genie In a Bottle",
    cover: "images/demure/Genie In a Bottle.jpg"
  },
  {
    file: "music/demure/Paparazzi.mp3",
    title: "Paparazzi",
    cover: "images/demure/Paparazzi.jpg"
  },
  {
    file: "music/demure/Rich Girl.mp3",
    title: "Rich Girl",
    cover: "images/demure/Rich Girl.jpg"
  },
  {
    file: "music/demure/Material Girl - 2024 Remaster.mp3",
    title: "Material Girl - 2024 Remaster",
    cover: "images/demure/Material Girl - 2024 Remaster.jpg"
  },
  {
    file: "music/demure/4 Minutes feat Justin Timberlake  Timbaland.mp3",
    title: "4 Minutes (feat. Justin Timberlake & Timbaland)",
    cover: "images/demure/4 Minutes (feat. Justin Timberlake.jpg"
  },
  {
    file: "music/demure/The Way I Are.mp3",
    title: "The Way I Are",
    cover: "images/demure/The Way I Are.jpg"
  },
  {
    file: "music/demure/Give It To Me.mp3",
    title: "Give It To Me",
    cover: "images/demure/Give It To Me.jpg"
  },
  {
    file: "music/demure/Long Way 2 Go.mp3",
    title: "Long Way 2 Go",
    cover: "images/demure/Long Way 2 Go.jpg"
  },
  {
    file: "music/demure/My Humps.mp3",
    title: "My Humps",
    cover: "images/demure/My Humps.jpg"
  },
  {
    file: "music/demure/Promiscuous.mp3",
    title: "Promiscuous",
    cover: "images/demure/Promiscuous.jpg"
  },
  {
    file: "music/demure/Superstar.mp3",
    title: "Superstar",
    cover: "images/demure/Superstar.jpg"
  },
  {
    file: "music/demure/Goodies feat Petey Pablo.mp3",
    title: "Goodies (feat. Petey Pablo)",
    cover: "images/demure/Goodies (feat. Petey Pablo).jpg"
  },
  {
    file: "music/demure/Gimme More.mp3",
    title: "Gimme More",
    cover: "images/demure/Gimme More.jpg"
  },
  {
    file: "music/demure/Say It Right.mp3",
    title: "Say It Right",
    cover: "images/demure/Say It Right.jpg"
  },
  {
    file: "music/demure/Hit Em Up Style Oops.mp3",
    title: "Hit 'Em Up Style (Oops!)",
    cover: "images/demure/Hit 'Em Up Style (Oops!).jpg"
  },
  {
    file: "music/demure/Lovefool.mp3",
    title: "Lovefool",
    cover: "images/demure/Lovefool.jpg"
  },
  {
    file: "music/demure/Maneater.mp3",
    title: "Maneater",
    cover: "images/demure/Maneater.jpg"
  },
  {
    file: "music/demure/Slumber Party feat Princess Nokia.mp3",
    title: "Slumber Party (feat. Princess Nokia)",
    cover: "images/demure/Slumber Party (feat. Princess Nokia).jpg"
  },

    {
    file: "music/demure/Cpr.mp3",
    title: "Cpr",
    cover: "images/demure/Cpr.jpg"
  },
  {
    file: "music/demure/Buttons.mp3",
    title: "Buttons",
    cover: "images/demure/Buttons.jpg"
  },
  {
    file: "music/demure/Naughty Girl.mp3",
    title: "Naughty Girl",
    cover: "images/demure/Naughty Girl.jpg"
  },
  {
    file: "music/demure/LoveGame.mp3",
    title: "LoveGame",
    cover: "images/demure/LoveGame.jpg"
  },
  {
    file: "music/demure/What You Waiting For.mp3",
    title: "What You Waiting For?",
    cover: "images/demure/What You Waiting For_.jpg"
  },
  {
    file: "music/demure/The Boy Is Mine.mp3",
    title: "The Boy Is Mine",
    cover: "images/demure/The Boy Is Mine.jpg"
  },
  {
    file: "music/demure/If You Had My Love.mp3",
    title: "If You Had My Love",
    cover: "images/demure/If You Had My Love.jpg"
  },
  {
    file: "music/demure/Foolish.mp3",
    title: "Foolish",
    cover: "images/demure/Foolish.jpg"
  },
  {
    file: "music/demure/Dark Horse.mp3",
    title: "Dark Horse",
    cover: "images/demure/Dark Horse.jpg"
  },
  {
    file: "music/demure/Harleys In Hawaii.mp3",
    title: "Harleys In Hawaii",
    cover: "images/demure/Harleys In Hawaii.jpg"
  },
  {
    file: "music/demure/SexyBack feat Timbaland.mp3",
    title: "SexyBack (feat. Timbaland)",
    cover: "images/demure/SexyBack (feat. Timbaland).jpg"
  },
  {
    file: "music/demure/Bills Bills Bills.mp3",
    title: "Bills, Bills, Bills",
    cover: "images/demure/Bills, Bills, Bills.jpg"
  },
  {
    file: "music/demure/Luxurious.mp3",
    title: "Luxurious",
    cover: "images/demure/Luxurious.jpg"
  },
  {
    file: "music/demure/Pretty Little Baby.mp3",
    title: "Pretty Little Baby",
    cover: "images/demure/Pretty Little Baby.jpg"
  },
  {
    file: "music/demure/Real Man.mp3",
    title: "Real Man",
    cover: "images/demure/Real Man.jpg"
  },
  {
    file: "music/demure/Oh My Angel.mp3",
    title: "Oh My Angel",
    cover: "images/demure/Oh My Angel.jpg"
  },
  {
    file: "music/demure/No One Noticed Extended English.mp3",
    title: "No One Noticed (Extended English)",
    cover: "images/demure/No One Noticed (Extended English).jpg"
  },
  {
    file: "music/demure/My Bubble Gum.mp3",
    title: "My Bubble Gum",
    cover: "images/demure/My Bubble Gum.jpg"
  },
  {
    file: "music/demure/Be My Baby.mp3",
    title: "Be My Baby",
    cover: "images/demure/Be My Baby.jpg"
  },
  {
    file: "music/demure/Love Me Not feat Rex Orange County.mp3",
    title: "Love Me Not (feat. Rex Orange County)",
    cover: "images/demure/Love Me Not (feat. Rex Orange County).jpg"
  },

    {
    file: "music/demure/Bout It.mp3",
    title: "'Bout It",
    cover: "images/demure/'Bout It.jpg"
  },
  {
    file: "music/demure/Juna.mp3",
    title: "Juna",
    cover: "images/demure/Juna.jpg"
  },
  {
    file: "music/demure/Slipping Through My Fingers.mp3",
    title: "Slipping Through My Fingers",
    cover: "images/demure/Slipping Through My Fingers.jpg"
  },
  {
    file: "music/demure/Margaret feat Bleachers.mp3",
    title: "Margaret (feat. Bleachers)",
    cover: "images/demure/Margaret (feat. Bleachers).jpg"
  },
  {
    file: "music/demure/Cinnamon Girl.mp3",
    title: "Cinnamon Girl",
    cover: "images/demure/Cinnamon Girl.jpg"
  },
  {
    file: "music/demure/Salvatore.mp3",
    title: "Salvatore",
    cover: "images/demure/Salvatore.jpg"
  },
  {
    file: "music/demure/Lilith.mp3",
    title: "Lilith",
    cover: "images/demure/Lilith.jpg"
  },
  {
    file: "music/demure/Love Potions.mp3",
    title: "Love Potions",
    cover: "images/demure/Love Potions.jpg"
  },
  {
    file: "music/demure/WILDFLOWER.mp3",
    title: "WILDFLOWER",
    cover: "images/demure/WILDFLOWER.jpg"
  },
  {
    file: "music/demure/Ojos Tristes with The Maras.mp3",
    title: "Ojos Tristes (with The Marías)",
    cover: "images/demure/Ojos Tristes (with The Marías).jpg"
  },
  {
    file: "music/demure/Soaked.mp3",
    title: "Soaked",
    cover: "images/demure/Soaked.jpg"
  },
  {
    file: "music/demure/Killshot.mp3",
    title: "Killshot",
    cover: "images/demure/Killshot.jpg"
  },
  {
    file: "music/demure/older.mp3",
    title: "older",
    cover: "images/demure/older.jpg"
  },
  {
    file: "music/demure/im yours.mp3",
    title: "i'm yours",
    cover: "images/demure/i'm yours.jpg"
  },
  {
    file: "music/demure/if u think im pretty.mp3",
    title: "if u think i'm pretty",
    cover: "images/demure/if u think i'm pretty.jpg"
  },
  {
    file: "music/demure/Diet Pepsi.mp3",
    title: "Diet Pepsi",
    cover: "images/demure/Diet Pepsi.jpg"
  },
  {
    file: "music/demure/Fetish feat Gucci Mane.mp3",
    title: "Fetish (feat. Gucci Mane)",
    cover: "images/demure/Fetish (feat. Gucci Mane).jpg"
  },
  {
    file: "music/demure/coute Chrie.mp3",
    title: "Écoute Chérie",
    cover: "images/demure/Écoute Chérie.jpg"
  },
  {
    file: "music/demure/Bubble Pop Electric.mp3",
    title: "Bubble Pop Electric",
    cover: "images/demure/Bubble Pop Electric.jpg"
  }
];

  
let currentTrackIndex = null;
let isLooping = false;
let isShuffling = false;
let queue = [];

const audio = document.getElementById("audio-player");
const seekbar = document.getElementById("seekbar");
const volumeSlider = document.getElementById("volume");
const currentTime = document.getElementById("current-time");
const totalDuration = document.getElementById("total-duration");
const titleDisplay = document.getElementById("player-title");
const coverDisplay = document.getElementById("player-cover");
const playIcon = document.getElementById("play-icon");
const playerBar = document.getElementById("custom-player");
const queueModal = document.getElementById("queue-modal");
const queueContent = document.getElementById("queue-list");

function showPlayerBar() {
  playerBar.style.display = "flex";
}

function updatePlayer(track) {
  audio.src = track.file;
  titleDisplay.textContent = track.title;
  coverDisplay.src = track.cover;
  playIcon.src = "images/icons/pause.svg";
  showPlayerBar();
  audio.play();
}

function queueAndPlay(index) {
  currentTrackIndex = index;
  updatePlayer(playlist[index]);
}

function playSong(file, title, cover) {
  const index = playlist.findIndex(song => song.file === file);
  if (index !== -1) currentTrackIndex = index;
  updatePlayer({ file, title, cover });
}

function togglePlay() {
  buttonGlow("play-pause");
  if (audio.paused) {
    audio.play();
    playIcon.src = "images/icons/pause.svg";
  } else {
    audio.pause();
    playIcon.src = "images/icons/play.svg";
  }
}

function toggleLoop() {
  isLooping = !isLooping;
  document.getElementById("loop").classList.toggle("active-glow", isLooping);
}

function toggleShuffle() {
  isShuffling = !isShuffling;
  document.getElementById("shuffle").classList.toggle("active-glow", isShuffling);
}

function prevSong() {
  buttonGlow("prev");
  if (currentTrackIndex === null) return;
  if (isShuffling) {
    currentTrackIndex = Math.floor(Math.random() * playlist.length);
  } else {
    currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
  }
  updatePlayer(playlist[currentTrackIndex]);
}

function nextSong() {
  buttonGlow("next");
  if (queue.length > 0) {
    const track = queue.shift();
    currentTrackIndex = playlist.findIndex(s => s.file === track.file);
    updatePlayer(track);
    updateQueueDisplay();
  } else if (isShuffling) {
    currentTrackIndex = Math.floor(Math.random() * playlist.length);
    updatePlayer(playlist[currentTrackIndex]);
  } else {
    currentTrackIndex = currentTrackIndex === null ? 0 : (currentTrackIndex + 1) % playlist.length;
    updatePlayer(playlist[currentTrackIndex]);
  }
}

function addToQueue(index) {
  if (index >= 0 && index < playlist.length) {
    queue.push(playlist[index]);
    updateQueueDisplay();
  }
}

function updateQueueDisplay() {
  queueContent.innerHTML = queue.map(track => `
    <li class="queue-item">
      <img src="${track.cover}" class="queue-thumb" alt="">
      <span>${track.title}</span>
    </li>
  `).join("");
}

function showQueue() {
  queueModal.classList.remove("hidden");
}

function hideQueue() {
  queueModal.classList.add("hidden");
}

volumeSlider.addEventListener("input", () => {
  audio.volume = volumeSlider.value;
});

audio.addEventListener("timeupdate", () => {
  if (!audio.duration) return;
  seekbar.value = (audio.currentTime / audio.duration) * 100;
  currentTime.textContent = formatTime(audio.currentTime);
  totalDuration.textContent = formatTime(audio.duration);
});

seekbar.addEventListener("input", () => {
  if (audio.duration) {
    audio.currentTime = (seekbar.value / 100) * audio.duration;
  }
});

audio.addEventListener("ended", () => {
  if (isLooping) {
    updatePlayer(playlist[currentTrackIndex]);
  } else {
    nextSong();
  }
});

function formatTime(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, "0")}`;
}

function buttonGlow(id) {
  const btn = document.getElementById(id);
  if (!btn) return;
  btn.classList.add("click-glow");
  setTimeout(() => btn.classList.remove("click-glow"), 300);
}

// Prevent Spotify/YT buttons from triggering song play
const songRows = document.querySelectorAll(".song-row");
songRows.forEach((row, index) => {
  const links = row.querySelectorAll("a");
  links.forEach(link => {
    link.addEventListener("click", e => e.stopPropagation());
  });
});
